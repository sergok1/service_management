# üõ°Ô∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞–º–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

–ù–∞–±–æ—Ä bash-—Å–∫—Ä–∏–ø—Ç–æ–≤ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–≥–µ–Ω—Ç–∞–º–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏—Ö —Ä–µ—Å—É—Ä—Å–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è.

## üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–ê–≥–µ–Ω—Ç—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (ManageEngine UEMS, Kaspersky Endpoint Security) –º–æ–≥—É—Ç –ø–æ—Ç—Ä–µ–±–ª—è—Ç—å –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã:
- **CPU:** –¥–æ 120% (–º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å)
- **RAM:** –¥–æ 3+ –ì–ë
- **I/O:** –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —á—Ç–µ–Ω–∏—è/–∑–∞–ø–∏—Å–∏

–≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ **–ø–æ–¥–≤–∏—Å–∞–Ω–∏—è–º —Å–∏—Å—Ç–µ–º—ã –∏ —Å–Ω–∏–∂–µ–Ω–∏—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**.

## üéØ –†–µ—à–µ–Ω–∏–µ

–≠—Ç–æ—Ç –Ω–∞–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –¥–≤–∞ –ø–æ–¥—Ö–æ–¥–∞:

1. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞–º–∏** ‚Äî –≤—Ä–µ–º–µ–Ω–Ω–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ/–≤–∫–ª—é—á–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç–æ–≤
2. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤** ‚Äî —Å–Ω–∏–∂–µ–Ω–∏–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ systemd

## üì¶ –°–æ—Å—Ç–∞–≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

| –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –†–∏—Å–∫ |
|------|-----------|------|
| `disable_services.sh` | –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤ | üî¥ –í—ã—Å–æ–∫–∏–π |
| `enable_services.sh` | –í–∫–ª—é—á–µ–Ω–∏–µ –∏ –∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤ | üü¢ –ù–∏–∑–∫–∏–π |
| `apply_resource_limits.sh` | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π CPU/RAM/IO | üü° –ù–∏–∑–∫–∏–π |
| `remove_systemd_overrides.sh` | –£–¥–∞–ª–µ–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π | üü¢ –ù–∏–∑–∫–∏–π |

### –£–ø—Ä–∞–≤–ª—è–µ–º—ã–µ —Å–µ—Ä–≤–∏—Å—ã

- **si.service** ‚Äî SIAGENT Endpoint Agent 6.14.2.3 (–æ—Å–Ω–æ–≤–Ω–æ–π –∞–≥–µ–Ω—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞)
  - –ü—Ä–æ—Ü–µ—Å—Å—ã: siagent, sid_lookup_server, traffic_parser, netfilter, x11monitor
  - –í–ª–∏—è–Ω–∏–µ: –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ —á–µ—Ä–µ–∑ TPROXY, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —ç–∫—Ä–∞–Ω–∞, –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
  - Unit-—Ñ–∞–π–ª: `/usr/lib/systemd/system/si.service`
  
- **dcservice.service** ‚Äî ManageEngine UEMS Agent
- **kesl.service** ‚Äî Kaspersky Endpoint Security for Linux
- **klnagent64.service** ‚Äî Kaspersky Network Agent
- **kaspersky-agent-check.service** ‚Äî Kaspersky Agent Check Service
- **kaspersky-agent-check.timer** ‚Äî –¢–∞–π–º–µ—Ä –∞–≤—Ç–æ–ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≥–µ–Ω—Ç–æ–≤

## üì¶ –°–æ—Å—Ç–∞–≤

- `disable_services.sh` ‚Äî –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤
- `enable_services.sh` ‚Äî –≤–∫–ª—é—á–µ–Ω–∏–µ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞ –∏ –∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤


## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –°–∫–∞—á–∞–π –æ–±–∞ —Å–∫—Ä–∏–ø—Ç–∞ –≤ —É–¥–æ–±–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥

2. –°–¥–µ–ª–∞–π –∏—Ö –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º–∏
    ```bash
    chmod +x disable_services.sh enable_services.sh
    ```
3. –í–∫–ª—é—á–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤
    ```bash
    sudo ./enable_services.sh
    ```
4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
    ```bash
    systemctl status dcservice.service kesl.service klnagent64.service si.service
    ```

## –£–¥–∞–ª–µ–Ω–∏–µ
    –û—Ç–∫–ª—é—á–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤
    ```bash
    sudo ./disable_services.sh
    ```

–ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç:
–û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤—Å–µ —É–∫–∞–∑–∞–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
–û—Ç–∫–ª—é—á–∞–µ—Ç –∏—Ö –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–∏—Å—Ç–µ–º—ã
–í—ã–≤–æ–¥–∏—Ç —Å—Ç–∞—Ç—É—Å –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
–õ–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –≤ /var/log/services_management.log

---



# üö¶ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–µ—Å—É—Ä—Å–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤

–ù–∞–±–æ—Ä bash-—Å–∫—Ä–∏–ø—Ç–æ–≤ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ (nice, ionice), –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å CPU/–ø–∞–º—è—Ç—å —á–µ—Ä–µ–∑ systemd drop-in.

## üìã –û–ø–∏—Å–∞–Ω–∏–µ


## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –°–∫–∞—á–∞–π –æ–±–∞ —Å–∫—Ä–∏–ø—Ç–∞ –≤ —É–¥–æ–±–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥

2. –°–¥–µ–ª–∞–π –∏—Ö –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º–∏
    ```bash
    chmod +x apply_resource_limits.sh enable_services.sh
    ```
3. –ó–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞
    ```bash
    sudo ./apply_resource_limits.sh
    ```

## –†—É—á–Ω–æ–π –æ—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π
1. –£–¥–∞–ª–∏ –∏–ª–∏ –ø–µ—Ä–µ–∏–º–µ–Ω—É–π —Ñ–∞–π–ª—ã /etc/systemd/system/<service>.service.d/override.conf
    ```bash
    sudo systemctl daemon-reload
    ```
    
    ```bash
    sudo systemctl restart <service>
    ```
## –°–∫—Ä–∏–ø—Ç –¥–ª—è –æ—Ç–∫–∞—Ç–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π
1. –°–¥–µ–ª–∞–π –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
    ```bash
    chmod +x remove_systemd_overrides.sh
    ```
2. –ó–∞–ø—É—Å—Ç–∏
    ```bash
    sudo ./remove_systemd_overrides.sh
    ```
3. –õ–æ–≥–∏ –¥–µ–π—Å—Ç–≤–∏–π —Ö—Ä–∞–Ω—è—Ç—Å—è
    ```
    /var/log/remove_overrides.log
    ```
4. –†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è
    ```
    /root/systemd_override_backups_YYYYMMDD_HHMMSS/
    ```

## üìã –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

- **–†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏** override.conf —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞.
- –î–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Å—Ç–æ —Å–∫–æ–ø–∏—Ä—É–π –Ω—É–∂–Ω—ã–π override.conf –æ–±—Ä–∞—Ç–Ω–æ:
  ```bash
  sudo cp /root/systemd_override_backups_YYYYMMDD_HHMMSS/<service>.service.d/override.conf /etc/systemd/system/<service>.service.d/override.conf
  sudo systemctl daemon-reload
  sudo systemctl restart <service>
  ```
- **–°–∫—Ä–∏–ø—Ç –Ω–µ —É–¥–∞–ª—è–µ—Ç –¥—Ä—É–≥–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ systemd –∏ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–∞–±–æ—Ç—É —Å–µ—Ä–≤–∏—Å–æ–≤, –∫—Ä–æ–º–µ —Å–Ω—è—Ç–∏—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π.**